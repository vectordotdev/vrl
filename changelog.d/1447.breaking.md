`encode_lz4` used the common method of prepending the uncompressed size to the first four bytes of the compressed payload. This allowed the consumer to decompress the payload, knowing the final size of the uncompressed data, and is fairly performant. Unfortunately, it's a pattern that is not universal and has resulted in payloads that couldn't be decompressed by a number of common libraries. An argument prepend_size has been introduced to turn this behaviour on or off, defaulting to false. decode_lz4 has the same argument, allowing for decoding of lz4 payloads that don't have the uncompressed size prepended. Decode also allows users to specify the buf_size (defaults to 1MB).

authors: jlambatl