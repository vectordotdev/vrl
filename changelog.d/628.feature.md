Add a `replace_with` function that is similar to `replace` but takes a closure instead of a
replacement string.
